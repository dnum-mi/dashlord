[
  {
    "templateID": "docker-compose-config",
    "info": {
      "name": "docker-compose.yml exposure",
      "author": "meme-lord,blckraven,geeknik",
      "severity": "medium",
      "tags": "config,exposure,devops"
    },
    "type": "http",
    "host": "https://beta.gouv.fr",
    "matched": "https://beta.gouv.fr/docker-compose.yml",
    "request": "GET /docker-compose.yml HTTP/1.1\r\nHost: beta.gouv.fr\r\nUser-Agent: Nuclei - Open-source project (github.com/projectdiscovery/nuclei)\r\nConnection: close\r\nAccept: */*\r\nAccept-Language: en\r\nAccept-Encoding: gzip\r\n\r\n",
    "response": "HTTP/1.1 200 OK\r\nConnection: close\r\nContent-Length: 161\r\nAccept-Ranges: bytes\r\nAge: 0\r\nCache-Control: public, max-age=0, must-revalidate\r\nContent-Type: application/x-yaml\r\nDate: Mon, 14 Jun 2021 20:33:52 GMT\r\nEtag: \"52098ad478ad49ad36c5249c39274c3d-ssl\"\r\nServer: Netlify\r\nStrict-Transport-Security: max-age=31536000\r\nX-Nf-Request-Id: e3dd310a-c415-4619-9ac7-6694134ff019-12907560\r\n\r\nversion: '2'\nservices:\n  web:\n    image: jekyll/jekyll\n    command: jekyll serve --incremental\n    volumes:\n      - .:/srv/jekyll\n    ports:\n      - \"4000:4000\"\n",
    "ip": "75.2.60.5",
    "timestamp": "2021-06-14T20:33:52.873618262Z"
  },
  {
    "templateID": "netlify-cms",
    "info": {
      "tags": "panel",
      "name": "Netlify CMS Admin Panel",
      "author": "sullo",
      "severity": "info"
    },
    "type": "http",
    "host": "https://beta.gouv.fr",
    "matched": "https://beta.gouv.fr/admin/index.html",
    "request": "GET /admin/index.html HTTP/1.1\r\nHost: beta.gouv.fr\r\nUser-Agent: Nuclei - Open-source project (github.com/projectdiscovery/nuclei)\r\nConnection: close\r\nAccept: */*\r\nAccept-Language: en\r\nAccept-Encoding: gzip\r\n\r\n",
    "response": "HTTP/1.1 200 OK\r\nConnection: close\r\nTransfer-Encoding: chunked\r\nAge: 0\r\nCache-Control: public, max-age=0, must-revalidate\r\nContent-Type: text/html; charset=UTF-8\r\nDate: Mon, 14 Jun 2021 20:34:16 GMT\r\nEtag: \"9397e37dd83cb9a0e0877b97def6a50f-ssl-df\"\r\nServer: Netlify\r\nStrict-Transport-Security: max-age=31536000\r\nVary: Accept-Encoding\r\nX-Nf-Request-Id: e3dd310a-c415-4619-9ac7-6694134ff019-12912175\r\n\r\n<!doctype html>\n<html>\n\n<head>\n  <meta charset=\"utf-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n  <title>Content Manager</title>\n  <link rel=\"apple-touch-icon\" sizes=\"57x57\" href=\"/assets/images/favicons/apple-touch-icon-57x57.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"60x60\" href=\"/assets/images/favicons/apple-touch-icon-60x60.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"72x72\" href=\"/assets/images/favicons/apple-touch-icon-72x72.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"76x76\" href=\"/assets/images/favicons/apple-touch-icon-76x76.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"114x114\" href=\"/assets/images/favicons/apple-touch-icon-114x114.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"120x120\" href=\"/assets/images/favicons/apple-touch-icon-120x120.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"144x144\" href=\"/assets/images/favicons/apple-touch-icon-144x144.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"152x152\" href=\"/assets/images/favicons/apple-touch-icon-152x152.png\">\n  <link rel=\"apple-touch-icon\" sizes=\"180x180\" href=\"/assets/images/favicons/apple-touch-icon-180x180.png\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/favicons/favicon-32x32.png\" sizes=\"32x32\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/favicons/android-chrome-192x192.png\" sizes=\"192x192\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/favicons/favicon-96x96.png\" sizes=\"96x96\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/favicons/favicon-16x16.png\" sizes=\"16x16\">\n  <link rel=\"manifest\" href=\"/assets/images/favicons/manifest.json\">\n  <link rel=\"mask-icon\" href=\"/assets/images/favicons/safari-pinned-tab.svg\">\n  <link rel=\"shortcut icon\" href=\"/assets/images/favicons/favicon.ico\">\n  <meta name=\"apple-mobile-web-app-title\" content=\"beta.gouv.fr\">\n  <meta name=\"application-name\" content=\"beta.gouv.fr\">\n  <meta name=\"msapplication-TileColor\" content=\"#042075\">\n  <meta name=\"msapplication-TileImage\" content=\"/assets/images/favicons/mstile-144x144.png\">\n  <meta name=\"msapplication-config\" content=\"/assets/images/favicons/browserconfig.xml\">\n  <meta name=\"theme-color\" content=\"#042075\">\n  <style>\n    /* Ugly hack that remove the Media icon from the navbar (it's the third element) */\n    nav>ul>li:nth-child(3) {\n      display: none;\n    }\n\n    button[class*=\"ToolbarButton-button-default-buttonMargin-noOverflow-DeleteButton-lightRed\"] {\n      display: none;\n    }\n\n    [class*='StyledWrapper']>[class*=\"AppHeaderQuickNewButton\"] {\n      background-color: #3a69c7;\n    }\n\n    [class*='CollectionTopNewButton'] {\n      background-color: #3a69c7 !important;\n    }\n\n    [class*=\"ToolbarSubSectionFirst\"]>[class*='SaveButton'] {\n      background-color: rgb(58, 105, 199);\n      color: white;\n      position: fixed;\n      font-size: 20px;\n    }\n\n    [class*=\"CustomIconWrapper\"]>img {\n      margin: auto;\n      display: block;\n    }\n  </style>\n</head>\n\n<body>\n  <!-- Include the script that builds the page and powers Netlify CMS -->\n  <script>\n      if(document.location.href.endsWith(\"/admin\")) {\n            window.location.href = \"/admin/\";   \n      }\n  </script>\n  <script src=\"https://unpkg.com/netlify-cms/dist/netlify-cms.js\"></script>\n  <script type=\"text/javascript\">\n    var oldHref = document.location.href;\n    var intervalID\n    function createExplanationParagraph() {\n      var p = document.createElement(\"p\");\n      p.className = \"onTheFlyElement\"\n      p.innerHTML = \"Une fois un changement enregistré, rendez-vous ensuite sur github pour merger ou demander une review sur la pull request : <a target='_blank' href='https://github.com/betagouv/beta.gouv.fr/pulls'>https://github.com/betagouv/beta.gouv.fr/pulls</a>\"\n      p.style = \"max-width: 800px; margin: 0px auto; padding-top: 16px; font-size: 16px;\"\n      return p\n    }\n    function setIntervalCheck() {\n      var count = 0\n      var panel = undefined\n      var authenticationElem = undefined\n      window.clearInterval(intervalID)\n      intervalID = window.setInterval(() => {\n        panel = document.querySelector('div[class*=\"ControlPaneContainer\"]');\n        var onTheFlyElement = document.querySelector('.onTheFlyElement');\n        // change save button position and add hint a the top and bottom of forms\n        if (panel && !onTheFlyElement) {\n          panel.prepend(createExplanationParagraph());\n          panel.append(createExplanationParagraph());\n          var saveButton = document.querySelector('[class*=\"SaveButton\"') || window.saveButton\n          window.saveButton = saveButton\n          if (saveButton) {\n            var parent = document.createElement('div');\n            parent.className = \"SaveButtonContainer\";\n            parent.style = \"max-width: 800px; margin: 0px auto; padding-top: 16px; font-size: 16px; position: relative; margin-top: 20px; margin-bottom: 100px;\";\n            saveButton.style = \"position: absolute; right: 0; bottom: 0;  background-color: rgb(58, 105, 199); color: white; font-size:20px;\";\n            panel.append(parent);\n            parent.appendChild(saveButton);\n          }\n        }\n        // change search bar position\n        var collectionMain = document.querySelector('[class*=\"CollectionMain\"]');\n        var searchContainer = document.querySelector('[class*=\"SearchContainer\"]') || window.searchContainer;\n        window.searchContainer = searchContainer\n        var onTheFlySearchContainerElement = document.querySelector('.onTheFlySearchContainerElement');\n        if (collectionMain && searchContainer && !onTheFlySearchContainerElement) {\n          var parent = document.createElement('div');\n          parent.className = \"onTheFlySearchContainerElement\";\n          parent.style = \"box-shadow: rgb(68 74 87 / 5%) 0px 2px 6px 0px, rgb(68 74 87 / 10%) 0px 1px 3px 0px; border-radius: 5px; background-color: rgb(255, 255, 255); width: 682px; max-width: 100%; padding: 18px 20px; margin-bottom: 22px;\";\n          collectionMain.prepend(parent);\n          parent.append(searchContainer);\n          var searchInput = searchContainer.querySelector('[class*=\"SearchInput\"]');\n          searchInput.placeholder = 'Rechercher un produit, un membre, ...'\n        }\n        \n        var createButton = document.querySelector('[class*=\"CollectionTopNewButton\"]');\n        if (createButton && createButton.innerText === 'Créer une entrée de type Produit') {\n          createButton.innerText = 'Créer une fiche produit'\n        } else if (createButton && createButton.innerText === 'Créer une entrée de type Membre') {\n          createButton.innerText = 'Créer une fiche Membre'\n        }\n        // change authentication page\n        authenticationElem = document.querySelector('[class*=\"StyledAuthenticationPage\"]');\n        var onTheFlyAuthenticationElem = document.querySelector('.onTheFlyAuthentificationElem');\n        if (authenticationElem && !onTheFlyAuthenticationElem) {\n          var onTheFlyAuthenticationElem = document.createElement('div');\n          onTheFlyAuthenticationElem.innerHTML = `<p>\n            <h1>Bonjour,</br>\n            Bienvenue sur l'admin beta.gouv.fr.</br></br></h1>\n            Après t'être connecté via Github, tu pourras :  </br><small>(si tu n'as pas de compte github tu peux voir la <a target=\"_blank\" style=\"text-decoration: underline\" href=\"https://doc.incubateur.net/communaute/outils/github\">doc</a> pour t'en créer un)</small></br></br>\n            <ul>\n              <li>ajouter ou éditer une fiche produit</li>\n              <li>éditer une fiche membre</li>\n              <li>ajouter ou éditer une fiche de recrutement</li>\n            </ul>\n          </p>`\n          onTheFlyAuthenticationElem.className = \"onTheFlyAuthentificationElem\";\n          onTheFlyAuthenticationElem.style = \"max-width: 500px; width:100%; margin: 0px auto; padding-top: 16px; font-size: 16px; position: absolute; margin-top: 20px; margin-bottom: 100px; top: 0px;\";\n          authenticationElem.prepend(onTheFlyAuthenticationElem)\n        }\n      }, 500);\n    }\n    setIntervalCheck()\n  </script>\n</body>\n\n</html>\n",
    "ip": "75.2.60.5",
    "timestamp": "2021-06-14T20:34:16.639602156Z"
  }
]
